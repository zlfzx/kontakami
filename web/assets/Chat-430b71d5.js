import{j as t,N as f,a as l,r as o,C as u,O as h,b as x}from"./index-6f41d611.js";import{u as g}from"./user-ca0d8e03.js";let c;c="/storage/profiles/";function p({chat:e}){const r=e.first_name+" "+e.last_name;let i="";if(e.last_sent){const a=new Date(e.last_sent*1e3);i=(a.getHours()<10?"0"+a.getHours():a.getHours())+":"+(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes())}const n=()=>{e.unread_messages&&(e.unread_messages=0)};return t(f,{to:`${e.id}`,className:"flex flex-row",onClick:n,children:l("div",{className:"flex items-center flex-1 p-4 cursor-pointer select-none hover:bg-gray-100",children:[t("div",{className:"flex flex-col items-center justify-center w-10 h-10 mr-4",children:t("span",{className:"relative block",children:t("img",{alt:"profil",src:e.profile_photo?c+e.profile_photo:g,className:"mx-auto object-cover rounded-full h-10 w-10 "})})}),l("div",{className:"flex-1 pl-1 mr-16",children:[t("div",{className:"font-medium dark:text-white",children:r}),t("div",{className:"text-sm text-gray-600 dark:text-gray-200",children:e.username})]}),l("div",{className:"text-xs text-gray-600 dark:text-gray-200",children:[t("div",{children:i}),!!e.unread_messages&&e.unread_messages>0&&t("div",{className:"mt-1 text-right",children:t("span",{className:"w-4 h-2 p-1 text-xs text-gray-500 bg-gray-200 rounded",children:e.unread_messages})})]})]})})}function w(){var n;const[e,r]=o.useContext(u),i=async()=>{const s=(await x.get("/api/v1/chat")).data.data;r({type:"SET_CHATS",payload:s});let d=0;s.forEach(m=>{d+=m.unread_messages}),r({type:"SET_UNREAD",payload:d})};return o.useEffect(()=>{i()},[]),o.useEffect(()=>{if(console.log("newChat",e.newChat),e.newChat!=null){let a=!1;for(let s=0;s<e.chats.length;s++)if(e.chats[s].id==e.newChat.id){a=!0;break}a||r({type:"SET_CHATS",payload:[e.newChat,...e.chats]})}},[e.newChat]),l("div",{className:"grid grid-cols-3 gap-4 w-full h-full",children:[l("div",{className:"col-span-1 bg-white shadow dark:bg-gray-800 h-full flex flex-col justify-start overflow-y-auto",children:[l("div",{className:"w-full px-4 py-5 border-b sm:px-6",children:[t("h3",{className:"text-lg font-medium leading-6 text-gray-900 dark:text-white",children:"Conversation"}),t("p",{className:"max-w-2xl mt-1 text-sm text-gray-500 dark:text-gray-200",children:"List conversation"})]}),t("div",{className:"h-full overflow-y-auto",children:t("ul",{className:"flex flex-col divide-y divide",children:(n=e.chats)==null?void 0:n.map(a=>t(p,{chat:a},a.id))})})]}),t("div",{className:"col-span-2 bg-white shadow dark:bg-gray-800 h-full flex flex-col justify-between overflow-y-auto",children:t(h,{})})]})}export{w as default};
