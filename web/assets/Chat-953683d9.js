import{j as t,N as c,a as s,r as o,C as m,O as f,b as u}from"./index-e8bc7082.js";import{u as x}from"./user-ca0d8e03.js";let d;d="/storage/profiles/";function h({chat:e}){const r=e.first_name+" "+e.last_name;let i="";if(e.last_sent){const a=new Date(e.last_sent*1e3);i=(a.getHours()<10?"0"+a.getHours():a.getHours())+":"+(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes())}const n=()=>{e.unread_messages&&(e.unread_messages=0)};return t(c,{to:`${e.id}`,className:"flex flex-row",onClick:n,children:s("div",{className:"flex items-center flex-1 p-4 cursor-pointer select-none hover:bg-gray-100",children:[t("div",{className:"flex flex-col items-center justify-center w-10 h-10 mr-4",children:t("span",{className:"relative block",children:t("img",{alt:"profil",src:e.profile_photo?d+e.profile_photo:x,className:"mx-auto object-cover rounded-full h-10 w-10 "})})}),s("div",{className:"flex-1 pl-1 mr-16",children:[t("div",{className:"font-medium dark:text-white",children:r}),t("div",{className:"text-sm text-gray-600 dark:text-gray-200",children:e.username})]}),s("div",{className:"text-xs text-gray-600 dark:text-gray-200",children:[t("div",{children:i}),!!e.unread_messages&&e.unread_messages>0&&t("div",{className:"mt-1 text-right",children:t("span",{className:"w-4 h-2 p-1 text-xs text-gray-500 bg-gray-200 rounded",children:e.unread_messages})})]})]})})}function v(){var n;const[e,r]=o.useContext(m),i=async()=>{const l=(await u.get("/api/v1/chat")).data;r({type:"SET_CHATS",payload:l.data})};return o.useEffect(()=>{i()},[]),o.useEffect(()=>{if(console.log("newChat",e.newChat),e.newChat!=null){let a=!1;for(let l=0;l<e.chats.length;l++)if(e.chats[l].id==e.newChat.id){a=!0;break}a||r({type:"SET_CHATS",payload:[e.newChat,...e.chats]})}},[e.newChat]),s("div",{className:"grid grid-cols-3 gap-4 w-full h-full",children:[s("div",{className:"col-span-1 bg-white shadow dark:bg-gray-800 h-full flex flex-col justify-start overflow-y-auto",children:[s("div",{className:"w-full px-4 py-5 border-b sm:px-6",children:[t("h3",{className:"text-lg font-medium leading-6 text-gray-900 dark:text-white",children:"Conversation"}),t("p",{className:"max-w-2xl mt-1 text-sm text-gray-500 dark:text-gray-200",children:"List conversation"})]}),t("div",{className:"h-full overflow-y-auto",children:t("ul",{className:"flex flex-col divide-y divide",children:(n=e.chats)==null?void 0:n.map(a=>t(h,{chat:a},a.id))})})]}),t("div",{className:"col-span-2 bg-white shadow dark:bg-gray-800 h-full flex flex-col justify-between overflow-y-auto",children:t(f,{})})]})}export{v as default};
